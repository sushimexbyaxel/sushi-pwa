<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Cocina Sushi</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

</span>

<style>
ul {
  margin: 5px 0 10px 15px;
}
li {
  margin-bottom: 4px;
}
body {
  font-family: Arial;
  background:#000;
  color:#fff;
  padding:10px;
  max-width:700px;
  margin:auto;
}
.card {
  background:#1f1f1f;
  padding:12px;
  margin:10px 0;
  border-radius:10px;
}
.estado {
  font-weight:bold;
}
button {
  margin-top:5px;
  padding:6px;
  border:none;
  border-radius:6px;
  background:#ff9800;
  font-weight:bold;
}
small {
  color:#ccc;
}
</style>
</head>

<body>

<h2>ğŸ‘¨â€ğŸ³ Cocina</h2>
<div id="pedidos">Cargando...</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbxFTMvsq1mR55_9W--Tpck5hurue8SJSo1LNm4tIGbnTIwSgXUKVFKyVwxLEQBWEqDh/exec";
const TOKEN = "SUSHI2025";

function cargar() {
  fetch(`${API}?action=pedidos&token=${TOKEN}`)
    .then(r => r.json())
    .then(data => {
      const div = document.getElementById("pedidos");
      div.innerHTML = "";

      data.forEach(p => {
        
        // âŒ No mostrar entregados
  if (p.estado === "ENTREGADO") return;
        
        div.innerHTML += `
<div class="card">
  <b>#${p.pedido_id}</b> - ${p.tipo}<br>
  <small>${p.fecha}</small><br><br>

  ğŸ‘¤ ${p.cliente}<br>
  ğŸ“ ${p.telefono}<br>
  ğŸ“ ${p.direccion || "Retiro"}<br><br>

  ğŸ£ Pedido:
  <ul>
    ${p.items.split(" | ").map(i => `<li>${i}</li>`).join("")}
  </ul>

  ğŸ’° Total: $${p.total}<br><br>

  <span class="estado">${p.estado}</span><br>
  <button onclick="estado('${p.pedido_id}','PREPARANDO')">Preparando</button>
  <button onclick="estado('${p.pedido_id}','LISTO')">Listo</button>
  <button onclick="estado('${p.pedido_id}','ENTREGADO')">Entregado</button>
</div>
`;
      });
    })
    .catch(err => {
      document.getElementById("pedidos").innerHTML = "âŒ Error cargando pedidos";
      console.error(err);
    });
}

function estado(id, estado) {
  fetch(`${API}?action=estado&token=${TOKEN}&id=${id}&estado=${estado}`)
    .then(() => cargar());
}

cargar();
setInterval(cargar, 5000);
</script>

</body>
</html>
